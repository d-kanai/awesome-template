# ğŸš€ ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆJestï¼‰ã‚’è‡ªå‹•å®Ÿè¡Œã—ã¦å“è³ªã‚’ä¿ã¤ãŸã‚ã®è¨­å®šã§ã™
name: Native UT

on:
  # ğŸ” main ãƒ–ãƒ©ãƒ³ãƒã¸ã® push ã¨ Pull Request ã‚’ç›£è¦–ã—ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã‚’ã‚«ãƒãƒ¼ã™ã‚‹
  push:
    branches: ["main"]
    paths:
      - "frontend_native/**"
  pull_request:
    branches: ["main"]
    paths:
      - "frontend_native/**"

jobs:
  native-ut:
    # ğŸ§ª ã‚¸ãƒ§ãƒ–åã¯ã€ŒRun native unit tests via pnpmã€ã‚’æ¡ç”¨ã—ã€å®Ÿè¡Œå†…å®¹ã‚’æ˜ç¢ºã«ã™ã‚‹
    name: Run native unit tests via pnpm
    runs-on: ubuntu-latest

    steps:
      # âœ… ãƒªãƒã‚¸ãƒˆãƒªå…¨ä½“ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ã¦å¾Œç¶šã®ã‚¹ãƒ†ãƒƒãƒ—ã§åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
      - name: Checkout repository
        uses: actions/checkout@v4

      # ğŸ“¦ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ¡ç”¨ã—ã¦ã„ã‚‹ pnpm ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³å·®ç•°ã‚’é¿ã‘ã‚‹
      - name: Set up pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 9.15.4

      # ğŸŸ¢ Node.js LTS (22.x) ç’°å¢ƒã‚’ç”¨æ„ã—ã€pnpm ã®ä¾å­˜ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ´»ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é«˜é€ŸåŒ–ã™ã‚‹
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "22"
          cache: "pnpm"
          cache-dependency-path: frontend_native/pnpm-lock.yaml

      # ğŸ§ª Jest ã‚’ CI ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹
      - name: Run native unit tests (Jest)
        run: |
          make native-ut
